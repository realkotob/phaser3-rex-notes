var t,e;t=void 0,e=function(){var t=Phaser.Renderer.WebGL.Utils,e=Phaser.Renderer.WebGL.Utils;const i=Phaser.GameObjects.GetCalcMatrix,r=Phaser.Renderer.Canvas.SetTransform;var s={renderWebGL:function(r,s,a,h){s.dirty&&(s.updateData(),s.dirty=!1),a.addToRenderList(s);var n=r.pipelines.set(s.pipeline),o=i(s,a,h),l=n.calcMatrix.copyFrom(o.calc),u=s._displayOriginX,d=s._displayOriginY,v=a.alpha*s.alpha;r.pipelines.preBatch(s),s.isFilled&&function(e,i,r,s,a,h){for(var n=t.getTintAppendFloatAlpha(r.fillColor,r.fillAlpha*s),o=r.pathData,l=r.pathIndexes,u=0;u<l.length;u+=3){var d=2*l[u],v=2*l[u+1],c=2*l[u+2],f=o[d+0]-a,g=o[d+1]-h,p=o[v+0]-a,y=o[v+1]-h,x=o[c+0]-a,P=o[c+1]-h,R=i.getX(f,g),m=i.getY(f,g),b=i.getX(p,y),k=i.getY(p,y),T=i.getX(x,P),D=i.getY(x,P);e.batchTri(r,R,m,b,k,T,D,0,0,1,1,n,n,n,2)}}(n,l,s,v,u,d),s.isStroked&&function(t,i,r,s,a){var h=t.strokeTint,n=e.getTintAppendFloatAlpha(i.strokeColor,i.strokeAlpha*r);h.TL=n,h.TR=n,h.BL=n,h.BR=n;var o,l,u=i.isDashed&&!!i.strokePathData,d=u?i.strokePathData:i.pathData,v=d.length-1,c=i.lineWidth,f=c/2,g=d[0]-s,p=d[1]-a;if(i.closePath||(v-=2),u){var y=i.strokePathMask,x=0,P=0;for(R=2;R<v;R+=2)o=d[R]-s,l=d[R+1]-a,y[x]?(t.batchLine(g,p,o,l,f,f,c,P,!1),P++):P=0,g=o,p=l,x++}else for(var R=2;R<v;R+=2)o=d[R]-s,l=d[R+1]-a,t.batchLine(g,p,o,l,f,f,c,R-2,!!i.closePath&&R===v-1),g=o,p=l}(n,s,v,u,d),r.pipelines.postBatch(s)},renderCanvas:function(t,e,i,s){e.dirty&&(e.updateData(),e.dirty=!1),i.addToRenderList(e);var a=t.currentContext;if(r(t,a,e,i,s)){var h=e._displayOriginX,n=e._displayOriginY;e.isFilled&&function(t,e,i,r){var s=e.pathData;if(s&&!(s.length<4)){var a=s.length-1,h=s[0]-i,n=s[1]-r;t.beginPath(),t.moveTo(h,n),e.closePath||(a-=2);for(var o=2;o<a;o+=2){var l=s[o]-i,u=s[o+1]-r;t.lineTo(l,u)}e.closePath&&t.closePath(),function(t,e,i,r){var s=e.fillColor,a=r||e.fillAlpha,h=(16711680&s)>>>16,n=(65280&s)>>>8,o=255&s;t.fillStyle="rgba("+h+","+n+","+o+","+a+")"}(t,e),t.fill()}}(a,e,h,n),e.isStroked&&function(t,e,i,r){var s=e.isDashed&&!!e.strokePathData,a=s?e.strokePathData:e.pathData;if(a&&!(a.length<4)){var h=a.length-1,n=a[0]-i,o=a[1]-r;if(function(t,e,i,r){var s=e.strokeColor,a=r||e.strokeAlpha,h=(16711680&s)>>>16,n=(65280&s)>>>8,o=255&s;t.strokeStyle="rgba("+h+","+n+","+o+","+a+")",t.lineWidth=e.lineWidth}(t,e),t.beginPath(),e.closePath||(h-=2),s){var l=e.strokePathMask,u=0;for(d=2;d<h;d+=2)v=a[d]-i,c=a[d+1]-r,l[u]&&(t.moveTo(n,o),t.lineTo(v,c)),n=v,o=c,u++}else{t.moveTo(n,o);for(var d=2;d<h;d+=2){var v=a[d]-i,c=a[d+1]-r;t.lineTo(v,c)}e.closePath&&t.closePath()}t.stroke()}}(a,e,h,n),a.restore()}}};const a=1e-6;var h=Phaser.Utils.Objects.GetValue,n=function(t,e){return function(t){if(!Array.isArray(t))return null;for(var e=[],i=0,r=t.length;i<r;i++){var s=Number(t[i]);isFinite(s)&&s>0&&e.push(s)}return e.length>0?e:null}(t)||function(t,e){var i=h(t,"segments",10),r=h(t,"drawRatio",.5);if(i=Math.round(Number(i)),!isFinite(i)||i<=0)return null;if(!(e>a))return null;var s=e/i;if(!(s>a))return null;if((r=Math.max(0,Math.min(1,r)))>=.999999)return null;var n=s*r;n<=a&&(n=a);var o=s-n;return o<=a?null:[n,o]}(t,e)},o=function(t,e,i){if(t&&!(t.length<4)){var r=t.length-1;if(e||(r-=2),!(r<2))for(var s=t[0],a=t[1],h=2;h<r;h+=2){var n=t[h],o=t[h+1];i(s,a,n,o),s=n,a=o}}},l=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i={});var r=h(e,"closePath",!1),s=function(t,e){var i=0;return o(t,e,(function(t,e,r,s){var a=r-t,h=s-e;i+=Math.sqrt(a*a+h*h)})),i}(t,r),l=n(h(e,"dashPattern",void 0),s),u=h(e,"dashOffset",0);if(null===l)return null;for(var d=[],v=[],c=0,f=0,g=l.length;f<g;f++)c+=l[f];if(c<=a)return i.strokePathData=t?t.slice():[],i.strokePathMask=void 0,i;for(var p=0,y=!0,x=l[p],P=function(){p=(p+1)%l.length,y=!y,x=l[p]},R=function(t,e){return isFinite(t)||(t=0),(t%=e)<0&&(t+=e),t}(u,c);R>a;)R<x-a?(x-=R,R=0):(R-=x,P());var m=function(t,e,i,r,s){if(0===d.length)d.push(t,e);else{var a=d[d.length-2],h=d[d.length-1];a===t&&h===e||d.push(t,e)}d.push(i,r),v.push(s?1:0)};return o(t,r,(function(t,e,i,r){var s=i-t,h=r-e,n=Math.sqrt(s*s+h*h);if(!(n<=a))for(var o=0;o<n-a;){var l=Math.min(x,n-o);if(l<=a)P();else{var u=o/n,d=(o+l)/n;m(t+s*u,e+h*u,t+s*d,e+h*d,y),o+=l,(x-=l)<=a&&P()}}})),!r&&d.length>=2&&d.push(d[d.length-2],d[d.length-1]),i.strokePathData=d,i.strokePathMask=v,i},u={setDashPattern(t,e=0){return this.dashPattern=t,this.dashOffset=e,this.isDashed=!!t,this},clearDashPattern(){return this.setDashPattern(),this},setDashed(t){return void 0===t&&(t=!0),this.isDashed=t,this},buildStrokePath(){if(this.isDashed){var t=l(this.pathData,{closePath:this.closePath,dashPattern:this.dashPattern,dashOffset:this.dashOffset},this);t?(this.strokePathData=t.strokePathData,this.strokePathMask=t.strokePathMask):this.isDashed=!1}return this}};const d=Phaser.GameObjects.Shape;class v extends d{init(){this.isDashed=!1,this.strokePathData=void 0,this.strokePathMask=void 0,this.dashPattern=void 0,this.dashOffset=0}get fillColor(){return this._fillColor}set fillColor(t){this._fillColor=t,this.isFilled=null!=t&&this._fillAlpha>0}get fillAlpha(){return this._fillAlpha}set fillAlpha(t){this._fillAlpha=t,this.isFilled=t>0&&null!=this._fillColor}setFillStyle(t,e){return void 0===e&&(e=1),this.fillColor=t,this.fillAlpha=e,this}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t,this.isStroked=null!=t&&this._strokeAlpha>0&&this._lineWidth>0}get strokeAlpha(){return this._strokeAlpha}set strokeAlpha(t){this._strokeAlpha=t,this.isStroked=t>0&&null!=this._strokeColor&&this._lineWidth>0}get lineWidth(){return this._lineWidth}set lineWidth(t){this._lineWidth=t,this.isStroked=t>0&&null!=this._strokeColor}setStrokeStyle(t,e,i){return void 0===i&&(i=1),this.lineWidth=t,this.strokeColor=e,this.strokeAlpha=i,this}updateData(){return this.buildStrokePath(),this}get width(){return this.geom.width}set width(t){this.resize(t,this.height)}get height(){return this.geom.height}set height(t){this.resize(this.width,t)}setSize(t,e){var i=this.input;return i&&!i.customHitArea&&(i.hitArea.width=t,i.hitArea.height=e),this}resize(t,e){return this.setSize(t,e),this}}Object.assign(v.prototype,u,s);const c=Phaser.Utils.Objects.GetValue;let f=class{constructor(t,e,i,r,s){void 0===t&&(t=0),void 0===e&&(e=t),void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=0),this.cornerRadius={},this._width=0,this._height=0,this.setTo(t,e,i,r,s)}setTo(t,e,i,r,s){return this.setPosition(t,e),this.setRadius(s),this.setSize(i,r),this}setPosition(t,e){return this.x=t,this.y=e,this}setRadius(t){return void 0===t&&(t=0),this.radius=t,this}setSize(t,e){return this.width=t,this.height=e,this}get minWidth(){var t=this.cornerRadius;return Math.max(t.tl.x+t.tr.x,t.bl.x+t.br.x)}get minHeight(){var t=this.cornerRadius;return Math.max(t.tl.y+t.bl.y,t.tr.y+t.br.y)}get width(){return this._width}set width(t){null==t&&(t=0),this._width=Math.max(t,this.minWidth)}get height(){return this._height}set height(t){null==t&&(t=0),this._height=Math.max(t,this.minHeight)}get radius(){var t=this.cornerRadius;return Math.max(t.tl.x,t.tl.y,t.tr.x,t.tr.y,t.bl.x,t.bl.y,t.br.x,t.br.y)}set radius(t){var e,i;"number"==typeof t?(e=t,i=t):(e=c(t,"x",0),i=c(t,"y",0));var r=this.cornerRadius;r.tl=g(c(t,"tl",void 0),e,i),r.tr=g(c(t,"tr",void 0),e,i),r.bl=g(c(t,"bl",void 0),e,i),r.br=g(c(t,"br",void 0),e,i)}get radiusTL(){var t=this.cornerRadius.tl;return Math.max(t.x,t.y)}set radiusTL(t){p(this.cornerRadius.tl,t)}get radiusTR(){var t=this.cornerRadius.tr;return Math.max(t.x,t.y)}set radiusTR(t){p(this.cornerRadius.tr,t)}get radiusBL(){var t=this.cornerRadius.bl;return Math.max(t.x,t.y)}set radiusBL(t){p(this.cornerRadius.bl,t)}get radiusBR(){var t=this.cornerRadius.br;return Math.max(t.x,t.y)}set radiusBR(t){p(this.cornerRadius.br,t)}};var g=function(t,e,i){return void 0===t?t={x:e,y:i}:"number"==typeof t&&(t={x:t,y:t}),y(t),t},p=function(t,e){"number"==typeof e?(t.x=e,t.y=e):(t.x=c(e,"x",0),t.y=c(e,"y",0)),y(t)},y=function(t){t.convex=t.x>=0||t.y>=0,t.x=Math.abs(t.x),t.y=Math.abs(t.y)},x=function(t){return t.x>0&&t.y>0},P=function(t,e,i){var r=i.length;if(r>=2){var s=i[r-2],a=i[r-1];if(t===s&&e===a)return i}return i.push(t,e),i};const R=Phaser.Math.DegToRad;var m=function(t,e,i,r,s,a,h,n,o){h&&a>s?a-=360:!h&&a<s&&(a+=360);var l=R(a-s)/n;s=R(s);for(var u=0;u<=n;u++){var d=s+l*u,v=t+i*Math.cos(d),c=e+r*Math.sin(d);P(v,c,o)}return o};const b=Phaser.Utils.Objects.IsPlainObject,k=Phaser.Utils.Objects.GetValue,T=Phaser.Geom.Polygon.Earcut;class D extends v{constructor(t,e,i,r,s,a,h,n){var o,l,u,d;if(b(e)){var v=e;e=v.x,i=v.y,r=v.width,s=v.height,a=v.radius,h=v.color,n=v.alpha,o=v.strokeColor,l=v.strokeAlpha,u=v.strokeWidth,d=v.shape}void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===s&&(s=r),void 0===a&&(a=0),void 0===d&&(d=0);var c=new f;if(super(t,"rexRoundRectangleShape",c),this.init(),this.setShapeType(d),0===this.shapeType){var g=k(a,"radius",a);c.setTo(0,0,r,s,g)}else g={x:r/2,y:s/2},c.setTo(0,0,r,s,g);this.setIteration(k(a,"iteration",void 0)),this.setPosition(e,i),this.setFillStyle(h,n),void 0===u&&(u=2),this.setStrokeStyle(u,o,l),this.updateDisplayOrigin(),this.dirty=!0}updateData(){var t=this.geom,e=this.pathData;e.length=0;var i,r=t.width,s=t.height,a=t.cornerRadius,h=this.iteration+1;if(i=a.tl,x(i))if(i.convex){var n=i.x,o=i.y;m(n,o,i.x,i.y,180,270,!1,h,e)}else m(n=0,o=0,i.x,i.y,90,0,!0,h,e);else P(0,0,e);return i=a.tr,x(i)?i.convex?(n=r-i.x,o=i.y,m(n,o,i.x,i.y,270,360,!1,h,e)):m(n=r,o=0,i.x,i.y,180,90,!0,h,e):P(r,0,e),i=a.br,x(i)?i.convex?(n=r-i.x,o=s-i.y,m(n,o,i.x,i.y,0,90,!1,h,e)):m(n=r,o=s,i.x,i.y,270,180,!0,h,e):P(r,s,e),i=a.bl,x(i)?i.convex?(n=i.x,o=s-i.y,m(n,o,i.x,i.y,90,180,!1,h,e)):m(n=0,o=s,i.x,i.y,360,270,!0,h,e):P(0,s,e),e.push(e[0],e[1]),this.pathIndexes=T(e),super.updateData(),this}setShapeType(t){return"string"==typeof t&&(t=A[t]),this.shapeType=t,this}setSize(t,e){return void 0===e&&(e=t),this.geom.width===t&&this.geom.height===e||(this.geom.setSize(t,e),1===this.shapeType&&this.setRadius({x:t/2,y:e/2}),this.updateDisplayOrigin(),this.dirty=!0,super.setSize(t,e)),this}get radius(){return this.geom.radius}set radius(t){this.geom.setRadius(t),this.updateDisplayOrigin(),this.dirty=!0}get radiusTL(){return this.geom.radiusTL}set radiusTL(t){this.geom.radiusTL=t,this.dirty=!0}get radiusTR(){return this.geom.radiusTR}set radiusTR(t){this.geom.radiusTR=t,this.dirty=!0}get radiusBL(){return this.geom.radiusBL}set radiusBL(t){this.geom.radiusBL=t,this.dirty=!0}get radiusBR(){return this.geom.radiusBR}set radiusBR(t){this.geom.radiusBR=t,this.dirty=!0}setRadius(t){return void 0===t&&(t=0),this.radius=t,this}setRadiusTL(t){return void 0===t&&(t=0),this.radiusTL=t,this}setRadiusTR(t){return void 0===t&&(t=0),this.radiusTR=t,this}setRadiusBL(t){return void 0===t&&(t=0),this.radiusBL=t,this}setRadiusBR(t){return void 0===t&&(t=0),this.radiusBR=t,this}get cornerRadius(){return this.geom.cornerRadius}set cornerRadius(t){this.radius=t}setCornerRadius(t){return this.setRadius(t)}get iteration(){return this._iteration}set iteration(t){void 0!==this._iteration?this._iteration!==t&&(this._iteration=t,this.dirty=!0):this._iteration=t}setIteration(t){return void 0===t&&(t=6),this.iteration=t,this}}const A={rectangle:0,circle:1};function _(t,e,i,r,s,a,h){var n=new D(this.scene,t,e,i,r,s,a,h);return this.scene.add.existing(n),n}const M=Phaser.Utils.Objects.GetAdvancedValue,O=Phaser.Utils.Objects.GetValue,S=Phaser.GameObjects.BuildGameObject;function L(t,e){void 0===t&&(t={}),void 0!==e&&(t.add=e);var i=M(t,"width",void 0),r=M(t,"height",i),s=O(t,"radius",void 0),a=M(t,"fillColor",void 0),h=M(t,"fillAlpha",void 0),n=new D(this.scene,0,0,i,r,s,a,h);return S(this.scene,n,t),n}var C=function(t){return null!==t&&"object"==typeof t};class B extends Phaser.Plugins.BasePlugin{constructor(t){super(t),t.registerGameObject("rexRoundRectangle",_,L)}start(){this.game.events.on("destroy",this.destroy,this)}}return function(t,e,i,r="."){if(!C(t))return t;if(function(t){return null==t}(e)||""===e||Array.isArray(e)&&0===e.length)return t;if("string"==typeof e&&-1===e.indexOf(r))return t[e]=i,t;var s=function(t,e){return Array.isArray(t)||(t="string"!=typeof t||""===t.trim()?[]:t.split(e).filter(Boolean)),t}(e,r);if(0===s.length)return t;for(var a=t,h=s.length,n=0;n<h-1;n++){var o=s[n],l=a[o];C(l)||(a[o]={}),a=a[o]}a[s[h-1]]=i}(window,"RexPlugins.GameObjects.RoundRectangle",D),B},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rexroundrectangleplugin=e();
